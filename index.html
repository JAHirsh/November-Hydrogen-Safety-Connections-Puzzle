<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hydrogen Safety Categories Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    margin: 0;
    padding: 20px;
    text-align: center;
}

h1 {
    color: #005e82;
    margin-bottom: 10px;
}

p.subtitle {
    margin-top: 0;
    font-size: 14px;
    color: #444;
}

.grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    max-width: 650px;
    margin: 20px auto;
}

.tile {
    background: #ffffff;
    border: 2px solid #dddddd;
    padding: 14px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    font-size: 14px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: background-color 0.2s, border-color 0.2s;
}

.selected {
    background: #bfe2f0;
    border-color: #005e82;
}

.group-found {
    background: #68bd49 !important;
    color: white;
    font-weight: bold;
    cursor: default;
}

button {
    margin-top: 20px;
    margin-right: 8px;
    padding: 10px 18px;
    background: #005e82;
    border-radius: 4px;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 14px;
}

button:disabled {
    background: #ccc;
    cursor: default;
}

#message {
    margin-top: 16px;
    font-size: 14px;
    color: #333;
    min-height: 20px;
    padding: 0 10px;
}

.footer-note {
    margin-top: 24px;
    font-size: 12px;
    color: #666;
}
</style>
</head>

<body>

<h1>Hydrogen Safety Categories</h1>
<p class="subtitle">
  Select 4 related terms to form a category. Inspired by the NYT <em>Connections</em> game.
</p>

<div class="grid" id="grid"></div>

<button id="submitBtn" disabled>Submit Selection</button>
<button id="shuffleBtn">Shuffle Tiles</button>

<h3 id="message"></h3>

<script>
// Base list of terms
const terms = [
    "Vent Stack", "Fill Connection", "Pressure Relief Valve", "Rupture Disk",
    "Electrolyzer", "Tube Trailer", "Mobile Refueler", "LHâ‚‚ Storage Tank",
    "Near-Miss", "Incident Report", "Root Cause Analysis", "Corrective Action",
    "Leak Detection Sensor", "UV/IR Detector", 
    "Gas Dispersion Modeling", "Lower Flammability Limit"
];

// Category definitions
let groups = [
    {
        items: ["Vent Stack", "Fill Connection", "Pressure Relief Valve", "Rupture Disk"],
        name: "Storage Tank Features"
    },
    {
        items: ["Electrolyzer", "Tube Trailer", "Mobile Refueler", "LHâ‚‚ Storage Tank"],
        name: "Hydrogen Infrastructure"
    },
    {
        items: ["Near-Miss", "Incident Report", "Root Cause Analysis", "Corrective Action"],
        name: "Incident Investigation & Learning"
    },
    {
        items: ["Leak Detection Sensor", "UV/IR Detector", 
                "Gas Dispersion Modeling", "Lower Flammability Limit"],
        name: "Hydrogen Behavior, Detection & Modeling"
    }
];

let selected = [];
const grid = document.getElementById("grid");
const submitBtn = document.getElementById("submitBtn");
const shuffleBtn = document.getElementById("shuffleBtn");
const message = document.getElementById("message");

// Fisherâ€“Yates Shuffle
function shuffle(array) {
    const arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

// Build tiles
function buildTiles() {
    grid.innerHTML = "";
    selected = [];
    submitBtn.disabled = true;
    message.innerText = "";

    // Reset group definitions so shuffle doesn't break the logic
    groups = [
        {
            items: ["Vent Stack", "Fill Connection", "Pressure Relief Valve", "Rupture Disk"],
            name: "Explosion / Fire Protection Equipment"
        },
        {
            items: ["Electrolyzer", "Tube Trailer", "Mobile Refueler", "LHâ‚‚ Storage Tank"],
            name: "Hydrogen Infrastructure"
        },
        {
            items: ["Near-Miss", "Incident Report", "Root Cause Analysis", "Corrective Action"],
            name: "Incident Investigation & Learning"
        },
        {
            items: ["Leak Detection Sensor", "UV/IR Detector", 
                    "Gas Dispersion Modeling", "Lower Flammability Limit"],
            name: "Hydrogen Behavior, Detection & Modeling"
        }
    ];

    const shuffled = shuffle(terms);

    shuffled.forEach(term => {
        const div = document.createElement("div");
        div.classList.add("tile");
        div.innerText = term;

        div.onclick = () => toggleSelect(div, term);

        grid.appendChild(div);
    });
}

// Tile select/deselect
function toggleSelect(div, term) {
    if (div.classList.contains("group-found")) return;

    if (selected.includes(term)) {
        div.classList.remove("selected");
        selected = selected.filter(t => t !== term);
    } else {
        if (selected.length < 4) {
            div.classList.add("selected");
            selected.push(term);
        }
    }

    submitBtn.disabled = (selected.length !== 4);
}

// Submit guess
submitBtn.onclick = () => {
    const matchIndex = groups.findIndex(g =>
        g.items.every(i => selected.includes(i))
    );

    if (matchIndex !== -1) {
        const match = groups[matchIndex];

        document.querySelectorAll(".tile").forEach(tile => {
            if (match.items.includes(tile.innerText)) {
                tile.classList.remove("selected");
                tile.classList.add("group-found");
            }
        });

        message.innerText = `âœ… Correct! Group found: ${match.name}`;

        groups.splice(matchIndex, 1);

        if (groups.length === 0) {
            message.innerText = "ðŸŽ‰ All groups found! Great work!";
            submitBtn.disabled = true;
        }
    } else {
        message.innerText = "âŒ Not a valid group â€” try again!";
        document.querySelectorAll(".selected").forEach(tile => tile.classList.remove("selected"));
    }

    selected = [];
    submitBtn.disabled = true;
};

// Shuffle button
shuffleBtn.onclick = () => {
    buildTiles();
};

// Initialize on load
buildTiles();
</script>

</body>
</html>
